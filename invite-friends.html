<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invite Friends</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="material/css/styles.css">
    <link rel="stylesheet" href="material/css/st.css">
</head>

<body>
    <div class="frens-invite">
        <div class="frens-invite-button">
            <input type="text" id="referralLink" value="Loading your referral link..." readonly>
            <button id="copyButton">Copy Link</button>
        </div>
    </div>

    <nav class="bottom-nav">
        <a href="home.html" class="nav-item">
            <i class="fas fa-home"></i>
            <span>HOME</span>
        </a>
        <a href="leaderboard.html" class="nav-item">
            <i class="fas fa-trophy"></i>
            <span>LEADERBOARD</span>
        </a>
        <a href="invite-friends.html" class="nav-item">
            <i class="fas fa-user-friends"></i>
            <span>FRIENDS</span>
        </a>
        <a href="task.html" class="nav-item">
            <i class="fas fa-tasks"></i>
            <span>TASKS</span>
        </a>
        <a href="balance.html" class="nav-item">
            <i class="fas fa-wallet"></i>
            <span>BALANCE</span>
        </a>
    </nav>

    <script src="material/js/cojs.js"></script>
    <script src="material/js/scripts.js"></script>

    <script>
        const apiUrl = "https://67496dde868020296630f628.mockapi.io/Api/1/Fox"; // Your MockAPI link
        const botLink = "https://t.me/FOXOG_BOT";

        const referralLinkInput = document.getElementById("referralLink");
        const copyButton = document.getElementById("copyButton");

        // Fetch the user's unique referral code from MockAPI
        async function fetchReferralLink() {
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error(`API responded with status ${response.status}`);

                const users = await response.json();
                console.log("API Response:", users); // Debug the response

                if (users.length === 0) throw new Error("No users found in MockAPI.");

                const currentUser = users[0]; // Assuming the first user in the list is the current user
                const referralCode = currentUser.referralCode || "defaultCode"; // Fallback value for missing referralCode
                const referralLink = `${botLink}?startapp=${referralCode}`;

                referralLinkInput.value = referralLink;
            } catch (error) {
                referralLinkInput.value = "Error fetching referral link.";
                console.error("Error:", error.message);
            }
        }

        // Copy the referral link to clipboard
        copyButton.addEventListener("click", () => {
            referralLinkInput.select();
            navigator.clipboard.writeText(referralLinkInput.value);
            alert("Referral link copied successfully!");
        });

        // Initialize
        fetchReferralLink();
    </script>

</body>

</html>
